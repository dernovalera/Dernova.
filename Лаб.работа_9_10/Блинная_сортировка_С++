#include <Windows.h>  // подключаем библиотеку для русского языка
#include <iostream> // подключение библиотеки для ввода-вывода
#include <vector>   // подключение библиотеки для работы с динамическими массивами

int findMaxIndex(std::vector<int>& arr, int start, int end) { // объявляем функцию, которая ищет индекс максимального элемента
    int maxIdx = start; // начинаем с предположения, что максимальный - это первый элемент диапазона
    for (int i = start + 1; i < end; ++i) { // перебираем все элементы диапазона, начиная со второго
        if (arr[i] > arr[maxIdx]) { // если текущий элемент больше, чем текущий максимум
            maxIdx = i; // запоминаем его индекс
        } // цикл продолжается до окончания диапазона
    }
    return maxIdx; // возвращаем индекс максимального элемента найденного диапазона
}

void reverseSubarray(std::vector<int>& arr, int start, int end) { // объявляем функцию для переворота части массива
    end--; // делаем end не включительным, чтобы удобно было использовать циклы (после этого диапазон для цикла [start, end))
    while (start < end) { // пока есть неперевернутый участок
        int temp = arr[start]; // сохраняем текущий левый элемент
        arr[start] = arr[end]; // переносим правый элемент в левую позицию
        arr[end] = temp; // вставляем сохранённый левый элемент в правую позицию
        start++; // двигаемся вперед с начала
        end--; // двигаемся назад с конца
    } // цикл продолжается, пока весь диапазон не отзеркалится
}

void pancakeSort(std::vector<int>& arr) { // функция сортировки методом "блинчиков"
    int n = arr.size(); // получаем размер массива
    for (int curr_size = n; curr_size > 1; --curr_size) { // цикл снизу вверх: уменьшает текущий размер сортируемой части
        int max_idx = findMaxIndex(arr, 0, curr_size); // ищем максимум в диапазоне [0, curr_size)
        if (max_idx != curr_size - 1) { // если максимум не на своем месте (не в конце текущего диапазона)
            reverseSubarray(arr, 0, max_idx + 1); // поднимает максимум в начало массива (делает его первым элементом).
            reverseSubarray(arr, 0, curr_size); // перемещает этот максимум на нужную позицию (в конец текущей части массива)
        }
    }
    // вывод массива
    std::cout << "Отсортированный массив: "; // выводим сообщение
    for (int num : arr) std::cout << num << " "; // выводим каждый элемент массива
    std::cout << std::endl; // перенос строки
}

int main() {  // вход в программу
    SetConsoleCP(65001);  // чтобы вводить на русском языке
    SetConsoleOutputCP(65001);  // чтобы выводить на русском языке
    std::vector<int> array = {31, 18, 45, 23}; // создаем исходный массив
    pancakeSort(array); // вызываем функцию сортировки
    return 0; 
}
